2025-11-07 16:27:28 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | FundingArbFeeCalculator initialized with 8 DEX fee structures
2025-11-07 16:27:29 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | FundingArbFeeCalculator initialized with 8 DEX fee structures
2025-11-07 16:27:29 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | Starting Funding Rate Service...
2025-11-07 16:27:29 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | Connecting to database...
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Database connected
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | Checking database migrations...
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | üîç Checking for pending database migrations...
2025-11-07 16:27:30 | DEBUG    | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Schema health check passed
2025-11-07 16:27:30 | DEBUG    | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Schema health check passed
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Database schema is up to date
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Database migrations completed
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | Loading mappers...
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | DEXMapper loaded: 7 DEXs
2025-11-07 16:27:30 | DEBUG    | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | DEX mappings: {'lighter': 1, 'edgex': 2, 'paradex': 3, 'grvt': 4, 'hyperliquid': 5, 'backpack': 6, 'aster': 7}
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | SymbolMapper loaded: 349 symbols
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Loaded 7 DEXs and 349 symbols
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | Initializing business logic components...
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | OpportunityFinder initialized
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Opportunity finder initialized
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | HistoricalAnalyzer initialized
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | ‚úÖ Historical analyzer initialized
2025-11-07 16:27:30 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | üöÄ Funding Rate Service API started successfully!
2025-11-07 16:27:31 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Using database credentials for account: acc1
2025-11-07 16:27:31 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Available exchanges: ['backpack', 'paradex', 'aster', 'lighter']
2025-11-07 16:27:31 | WARNING  | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Proxy assignments loaded but session proxy is disabled
2025-11-07 16:27:31 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Creating clients for exchanges: ['lighter', 'paradex']
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Created 2 exchange clients: ['lighter', 'paradex']
2025-11-07 16:27:37 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | FundingArbFeeCalculator initialized with 8 DEX fee structures
2025-11-07 16:27:37 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | OpportunityFinder initialized
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Strategy 'funding_arbitrage' created successfully
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Multi-symbol strategy: Contract attributes will be fetched per-symbol
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | === Trading Configuration ===
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Ticker: ALL
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Quantity: 1
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Exchange: lighter
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Strategy: funding_arbitrage
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Strategy Parameters:
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   scan_exchanges: ['lighter', 'paradex']
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   mandatory_exchange: lighter
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   target_exposure: 120.0
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   max_positions: 1
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   max_total_exposure_usd: 200.0
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   min_profit_rate: 0.00022831050228310502
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   risk_strategy: combined
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   profit_erosion_threshold: 0.4
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   min_hold_hours: 2
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   max_position_age_hours: 168
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   max_new_positions_per_cycle: 1
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   limit_order_offset_pct: 0.0002
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   check_interval_seconds: 60
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   dry_run: False
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   max_oi_usd: 1500000.0
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _config_path: configs/config.yml
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _account_name: acc1
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _account_credentials: {'backpack': {'secret_key': 'SYqtA6BbEuAa8KmmXCbpdTnSWmxKnIjwSLPCykFxeAk=', 'subaccount_index': 0, 'public_key': '7pGXGgpJMI1j2SrLIQFVeJyT9qM7kAMDUK/xZT+kICE='}, 'paradex': {'subaccount_index': 0, 'l1_address': '0xcb3c44718789f3eA8E3E8195dBd0a8e88Dd53469', 'l2_address': '0x30533b75f6b94471f762b9a61d324c8f483ca7a938fc2ee44ef26b38d7f143d', 'environment': 'prod', 'l2_private_key_hex': '0x388cc18c47e8fbfdd79f3a6125bbc210f5bf5e8466f3c6ea1365a84fa5cc885'}, 'aster': {'api_key': '2b4fb053e2bb74ce374fde69a1e53273b7c65a0747337bd7046440679f0a184f', 'secret_key': 'b6e690df5ab7f47df476796229e94b9fec262b33a4b4cdeb50c94a25318ab05f', 'subaccount_index': 0}, 'lighter': {'subaccount_index': 0, 'private_key': '6b667422bcd62187a62a5a3b6b229cd40516ef8f3edf53fa8ce9a77f15f2451640ba2285cd71511e', 'account_index': '213803', 'api_key_index': '2'}}
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _proxy_enabled: False
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _proxy_egress_ip: None
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL |   _proxy_egress_source: None
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | =============================
2025-11-07 16:27:37 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Connecting to lighter...
2025-11-07 16:27:38 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Client initialized (skipping API key validation to save rate limit)
2025-11-07 16:27:39 | INFO     | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] üîó Connected to websocket
2025-11-07 16:27:39 | INFO     | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Websocket receive timeout: 45s (server handles ping/pong messages)
2025-11-07 16:27:39 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Waiting for WebSocket positions stream (saves 300 weight REST call)
2025-11-07 16:27:39 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | Subscribed to notification channel
2025-11-07 16:27:39 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | Subscribed to user stats channel (real-time balance updates)
2025-11-07 16:27:39 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | Subscribed to account positions channel
2025-11-07 16:27:41 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] WebSocket positions not ready yet (will use REST fallback when needed)
2025-11-07 16:27:41 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Connected to lighter
2025-11-07 16:27:41 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Connecting to paradex...
2025-11-07 16:27:43 | INFO     | EXCHANGE:PARADEX:ticker=ALL         | Using L2 address: 0x30533b75f6b94471f762b9a61d324c8f483ca7a938fc2ee44ef26b38d7f143d
2025-11-07 16:27:46 | INFO     | EXCHANGE:PARADEX:ticker=ALL         | Subscribed to order updates for 
2025-11-07 16:27:46 | INFO     | EXCHANGE:PARADEX:ticker=ALL         | Subscribed to order book updates for 
2025-11-07 16:27:46 | INFO     | EXCHANGE:PARADEX:ticker=ALL         | Subscribed to fills updates for  (includes liquidations)
2025-11-07 16:27:46 | INFO     | BOT:FUNDING_ARBITRAGE:exchange=lighter:ticker=ALL | Connected to paradex
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Database connection established
2025-11-07 16:27:46 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | DEXMapper loaded: 7 DEXs
2025-11-07 16:27:46 | DEBUG    | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | DEX mappings: {'lighter': 1, 'edgex': 2, 'paradex': 3, 'grvt': 4, 'hyperliquid': 5, 'backpack': 6, 'aster': 7}
2025-11-07 16:27:46 | INFO     | SERVICE:FUNDING_RATE_SERVICE:log_level=INFO | SymbolMapper loaded: 349 symbols
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Loaded account_id b1fb8811-b6f5-4b8c-8586-44d6517cb785 for account 'acc1'
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Position manager initialized with 1 open positions (account: acc1)
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | FundingArbitrageStrategy initialized successfully
2025-11-07 16:27:46 | DEBUG    | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Started background monitor loop
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Strategy 'Funding Rate Arbitrage' initialized
2025-11-07 16:27:46 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | üö´ Max positions reached (1/1). Skipping new opportunities until capacity frees up.
2025-11-07 16:27:46 | DEBUG    | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | No capacity for new positions; skipping opportunity scan
2025-11-07 16:27:47 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Refreshing positions via REST fallback
2025-11-07 16:27:48 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Processing position: symbol=EDEN, qty=1060.8, market_id=89
2025-11-07 16:27:48 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Funding missing for EDEN: funding_accrued=None, total_funding_paid_out=None
2025-11-07 16:27:48 | INFO     | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Querying position_funding() API for EDEN (no cache, )
2025-11-07 16:27:48 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Using provided position_opened_at timestamp 1762528456.563344 (skipping trades API call)
2025-11-07 16:27:48 | INFO     | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Funding for current position (market_id=89): $-0.0014 (from 6 records, filtered 5 before position opened at 1762528456.563344)
2025-11-07 16:27:48 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Cached funding for EDEN: -0.001432 (will refresh after 20 minutes or on websocket update)
2025-11-07 16:27:48 | INFO     | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Position EDEN snapshot [Account: acc1]
Yield (annualised) | entry 37.1161% | current 20.5860% | erosion 55.46% (limit 40.00%)
Min hold: ACTIVE (46m remaining, risk checks resume 2025-11-07 17:14:16)
------------------------------------------------------------------------------------------------
Exchange     Side   Qty         Entry        Mark         uPnL         Funding      Funding APY 
------------------------------------------------------------------------------------------------
LIGHTER     long    1060.8000    0.113090    0.114250        1.23       -0.00    10.5120%
2025-11-07 16:27:48 | DEBUG    | EXCHANGE:LIGHTER:ticker=ALL         | [LIGHTER] Looking for ticker 'EDEN' as 'EDEN' in Lighter markets
2025-11-07 16:27:49 | DEBUG    | STRATEGY:FUNDING_RATE_ARBITRAGE:exchange=lighter:ticker=ALL:account=acc1 | Background monitor loop stopped
2025-11-07 16:27:49 | INFO     | EXCHANGE:LIGHTER:ticker=ALL         | WebSocket listener stopped
