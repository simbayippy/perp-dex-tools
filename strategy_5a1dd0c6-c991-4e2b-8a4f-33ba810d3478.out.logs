[32m2025-11-13 18:49:08[0m | [1mINFO    [0m | [36mposition_monit:_log_exchange_metrics:296[0m | [1mPosition DYDX snapshot [Account: acc1]
Yield (annualised) | entry 40.1274% | current 15.9921% | erosion 39.85% (limit 40.00%)
Min hold: satisfied (risk checks active since 2025-11-13 18:32:06)
Max hold: 10h 43m remaining (force close at 2025-11-14 05:32:06, configured: 12h)
------------------------------------------------------------------------------------------------
Exchange     Side   Qty         Entry        Mark         uPnL         Funding      Funding APY 
------------------------------------------------------------------------------------------------
LIGHTER     short   2163.2000    0.322710    0.299685       49.81        0.01    10.5120%
PARADEX     long    2163.2000    0.323768    0.299917      -51.43        0.03    -5.4801%[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 7 raw opportunities, 7 after filtering, returning top 1[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mposition_clos:_close_legs_atomically:929[0m | [1mðŸ”’ Closing position DYDX atomically | Reason: PROFIT_EROSION | Legs: [PARADEX:sell:2163.2, LIGHTER:buy:2163.2][0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:116         [0m | [1mStarting atomic execution of 2 orders (rollback_on_partial=True)[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1mclose.2. ðŸš€ Order Placement[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:143         [0m | [1mðŸš€ Placing all orders simultaneously...[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸ”´ [PARADEX] Executing sell DYDX ($648.781492736 qty=2163.2) in mode limit_only[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2991, ask=0.3006[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[PARADEX] Placing limit sell DYDX (contract_id=DYDX-USD-PERP): 2163.2 @ $0.2992 (mid: $0.29985, offset: 0.0200%)[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸŸ¢ [LIGHTER] Executing buy DYDX ($648.2785920 qty=2163.2) in mode limit_only[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29936, ask=0.30001[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[LIGHTER] Placing limit buy DYDX (contract_id=62): 2163.2 @ $0.29995 (mid: $0.299685, offset: 0.0200%)[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36morder_manager:place_limit_order:185     [0m | [1mðŸ“¤ [LIGHTER] Submitting order: market=62 client_id=749449 side=BID price=29995 amount=21632[0m
[32m2025-11-13 18:49:09[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:118   [0m | [1m[WEBSOCKET] [PARADEX] OPEN 2163.2 @ 0.2992[0m
[32m2025-11-13 18:49:10[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:107   [0m | [1m[WEBSOCKET] [PARADEX] FILLED 2163.2 @ 0.2992[0m
[32m2025-11-13 18:49:10[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:445       [0m | [1m[PARADEX] Limit order filled: 2163.2 @ $0.2992[0m
[32m2025-11-13 18:49:10[0m | [1mINFO    [0m | [36mexecutor:_handle_full_fill_trigger:873  [0m | [1mâœ… PARADEX DYDX fully filled (2163.2). Cancelling remaining limit orders and hedging to prevent directional exposure.[0m
[32m2025-11-13 18:49:10[0m | [1mINFO    [0m | [36mexecutor:_handle_full_fill_trigger:882  [0m | [1mðŸ”„ Cancelling limit order for LIGHTER DYDX (remaining: 2163.2) â†’ will hedge with market order[0m
[32m2025-11-13 18:49:11[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:171   [0m | [1m[WEBSOCKET] [LIGHTER] OPEN 2163.2 @ 0.29995[0m
[32m2025-11-13 18:49:12[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] PARTIALLY_FILLED 0.1 @ 0.29995[0m
[32m2025-11-13 18:49:12[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:400       [0m | [1m[LIGHTER] Cancellation requested for limit order 749449[0m
[32m2025-11-13 18:49:12[0m | [1mINFO    [0m | [36m...:_build_partial_execution_result:373 [0m | [1m[LIGHTER] Limit order 749449 limit_cancelled after partial fill 0.1 @ $0.29995[0m
[32m2025-11-13 18:49:13[0m | [1mINFO    [0m | [36mexecutor:_handle_full_fill_trigger:974  [0m | [1mâœ… Close operation: Both orders filled, positions closed. No hedge needed.[0m
[32m2025-11-13 18:49:14[0m | [1mINFO    [0m | [36mposition_m:_get_funding_for_snapshot:338[0m | [1m[LIGHTER] Querying position_funding() API for DYDX (no cache)[0m
[32m2025-11-13 18:49:14[0m | [1mINFO    [0m | [36mposition_mana:get_cumulative_funding:687[0m | [1m[LIGHTER] Funding for current position (market_id=62): $0.0082 (from 5 records, filtered 4 before position opened at 1763055122449)[0m
[32m2025-11-13 18:49:14[0m | [33m[1mWARNING [0m | [36mexecutor:execute_atomically:381         [0m | [33m[1mâš ï¸ Post-trade exposure detected after hedging: net_qty=2163.100000, net_usd=$649.4924 (100.00%).[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] PARTIALLY_FILLED 0.2 @ 0.29995[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36mposition_m:_get_funding_for_snapshot:338[0m | [1m[LIGHTER] Querying position_funding() API for DYDX (no cache)[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] CANCELED 0.2 @ 0.29995[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: BUY 0.2 @ 0.29995 | Order: 749449 | Status: CANCELED[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36mposition_mana:get_cumulative_funding:687[0m | [1m[LIGHTER] Funding for current position (market_id=62): $0.0082 (from 5 records, filtered 4 before position opened at 1763055122449)[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36m...:_cleanup_residual_positions:1049    [0m | [1mðŸ§¹ Cleaning up residual positions for DYDX: [LIGHTER:buy:2163.0][0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36m...:_cleanup_residual_positions:1082    [0m | [1mðŸ§¹ Closing residual DYDX on LIGHTER: buy 2163.0 @ ~$0.300260 ($649.46)[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸŸ¢ [LIGHTER] Executing buy DYDX ($649.462380 qty=2163.0) in mode market_only[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29969, ask=0.30057[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36morder_executor:_execute_market:588      [0m | [1m[LIGHTER] Placing market buy DYDX (contract_id=62): 2163.0 @ ~$0.30057[0m
[32m2025-11-13 18:49:15[0m | [1mINFO    [0m | [36morder_manager:place_market_order:392    [0m | [1mðŸ“¤ [LIGHTER] Placing market order: market=62, client_id=755697, side=BUY, base_amount=21630, avg_execution_price=31514[0m
[32m2025-11-13 18:49:18[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] FILLED 2163.0 @ 0.31514[0m
[32m2025-11-13 18:49:18[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: BUY 2163.0 @ 0.31514 | Order: 755697 | Status: FILLED[0m
[32m2025-11-13 18:49:18[0m | [1mINFO    [0m | [36morder_executor:_execute_market:714      [0m | [1m[LIGHTER] Market order filled: 2163.0 @ $0.31514 (slippage: $31.51 / 4.847%)[0m
[32m2025-11-13 18:49:18[0m | [1mINFO    [0m | [36m...:_cleanup_residual_positions:1101    [0m | [1mâœ… Residual position closed on LIGHTER: 2163.0 @ 0.31514[0m
[32m2025-11-13 18:49:18[0m | [33m[1mWARNING [0m | [36m...:handle_positions_stream_update:435  [0m | [33m[1mâš ï¸ [LIGHTER] Position suddenly zeroed: DYDX | Previous qty: 2163.0 | Market ID: 62 | Possible liquidation (no liquidation notification received)[0m
[32m2025-11-13 18:49:19[0m | [1mINFO    [0m | [36mposition_manager:close:654              [0m | [1mâœ… Closed position 0a10b38e-89af-4917-b4d0-19982ee60336: DYDX Reason: PROFIT_EROSION, PnL: $-53.27, Duration: 1.3h[0m
[32m2025-11-13 18:49:19[0m | [1mINFO    [0m | [36mposition_closer:close:415               [0m | [1mâœ… Closed DYDX (PROFIT_EROSION): PnL=$-53.27 (-8.03%), Age=1.3h[0m
[32m2025-11-13 18:49:19[0m | [1mINFO    [0m | [36mposition_c:evaluateAndClosePositions:124[0m | [1mClosed DYDX: PROFIT_EROSION[0m
[32m2025-11-13 18:50:06[0m | [1mINFO    [0m | [36mstrategy:execute_strategy:229           [0m | [1mScanning for new funding arbitrage opportunities[0m
[32m2025-11-13 18:50:06[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 1 raw opportunities, 1 after filtering, returning top 1[0m
[32m2025-11-13 18:50:06[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:71             [0m | [1mâ­ï¸  Skipped opportunities for symbols: CC (temporary filter)[0m
[32m2025-11-13 18:50:06[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:73             [0m | [1mFound 0 opportunities[0m
[32m2025-11-13 18:51:06[0m | [1mINFO    [0m | [36mstrategy:execute_strategy:229           [0m | [1mScanning for new funding arbitrage opportunities[0m
[32m2025-11-13 18:51:06[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 1 raw opportunities, 1 after filtering, returning top 1[0m
[32m2025-11-13 18:51:06[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:71             [0m | [1mâ­ï¸  Skipped opportunities for symbols: CC (temporary filter)[0m
[32m2025-11-13 18:51:06[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:73             [0m | [1mFound 0 opportunities[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mstrategy:execute_strategy:229           [0m | [1mScanning for new funding arbitrage opportunities[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 2 raw opportunities, 2 after filtering, returning top 2[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:71             [0m | [1mâ­ï¸  Skipped opportunities for symbols: CC (temporary filter)[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:73             [0m | [1mFound 1 opportunities[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m1. ðŸ“‹ DYDX â€¢ Opportunity Validation[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:209      [0m | [1mEnsuring DYDX is tradeable on both paradex and lighter[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:988     [0m | [1mðŸ”§ [PARADEX] Initializing contract attributes for DYDX[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:1006    [0m | [1mâœ… [PARADEX] DYDX initialized â†’ contract_id=DYDX-USD-PERP, tick_size=0.0001[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:228      [0m | [1mâœ… DYDX available on both PARADEX and LIGHTER[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m2. ðŸ” Leverage Validation & Normalization[0m
[32m2025-11-13 18:52:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:08[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mleverage_valid:get_max_position_size:266[0m | [1mâœ… [LEVERAGE] Position size $700.00 supported by all exchanges[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [PARADEX] Max leverage for DYDX: 20x[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [LIGHTER] Max leverage for DYDX: 5x[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:345      [0m | [1mðŸ”§ [LEVERAGE] Normalizing to minimum leverage: 5x (limited by lighter)[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:367[0m | [1m[PARADEX] Setting leverage for DYDX (DYDX-USD-PERP) to 5x...[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:389[0m | [1mâœ… [PARADEX] Successfully set leverage to 5x for DYDX (DYDX-USD-PERP)[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:363      [0m | [1mâœ… [PARADEX] Leverage set to 5x for DYDX[0m
[32m2025-11-13 18:52:09[0m | [33m[1mWARNING [0m | [36m...:normalize_and_set_leverage:355      [0m | [33m[1mâš ï¸  [LIGHTER] Does not support set_account_leverage(), skipping[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:375      [0m | [1mâœ… [LEVERAGE] All exchanges normalized to 5x for DYDX[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:247      [0m | [1mðŸŽ¯ Execution plan for DYDX: Long PARADEX ($700.00) | Short LIGHTER ($700.00) | Divergence 0.030%[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3. ðŸ§¨ Atomic Multi-Order Execution[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2979, ask=0.2991[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29882, ask=0.29917[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:116         [0m | [1mStarting atomic execution of 2 orders (rollback_on_partial=True)[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1. ðŸ” Pre-flight Checks[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.2. ðŸ’° Margin & Balance Checks[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1277     [0m | [1mRunning balance checks...[0m
[32m2025-11-13 18:52:09[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:291   [0m | [1mðŸ“Š [PARADEX] Leverage info for DYDX:
  - Symbol max leverage: 20.0x
  - Account leverage: N/Ax
  - Max notional: 4860000
  - Margin requirement: 0.0500 (5.0%)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:258   [0m | [1mðŸ“Š [LIGHTER] Leverage info for DYDX:
  - Symbol max leverage: 5.0x
  - Account leverage: 5E+2x
  - Max notional: None
  - Margin requirement: 0.2 (20.0%)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… paradex balance OK: $127.30 >= $36.75[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… lighter balance OK: $241.36 >= $146.87[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.3. ðŸŒŠ Order Book Liquidity[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1349     [0m | [1mRunning liquidity checks...[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mmarket_data:get_order_book_depth:216    [0m | [1mðŸ“¡ [PARADEX] Using WebSocket order book with exact BBO prices: DYDX-USD-PERP (2 bids, 2 asks) | Best: 0.2979/0.2991 | Spread: 40 bps[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:172     [0m | [1mðŸ“Š [LIQUIDITY-paradex] DYDX: 2 bids, 2 asks | Best: 0.2979/0.2991 | Spread: 40 bps[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:189     [0m | [1mðŸ“ˆ [LIQUIDITY-paradex] Fill analysis: Can fill: True, Levels needed: 1/2, Total available: $700.01[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:239     [0m | [1mâœ… [LIQUIDITY-paradex] VERDICT for buy $700.01364 DYDX: Recommendation='use_limit' | Score=0.92 | Slippage=0.000% | Spread=40bps[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mmarket_data:get_order_book_depth:360    [0m | [1mðŸ“¡ [LIGHTER] Using real-time order book from WebSocket (20 bids, 20 asks)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:172     [0m | [1mðŸ“Š [LIQUIDITY-lighter] DYDX: 20 bids, 20 asks | Best: 0.29882/0.29917 | Spread: 11 bps[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:189     [0m | [1mðŸ“ˆ [LIQUIDITY-lighter] Fill analysis: Can fill: True, Levels needed: 1/20, Total available: $699.36[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:239     [0m | [1mâœ… [LIQUIDITY-lighter] VERDICT for sell $699.358328 DYDX: Recommendation='use_limit' | Score=0.98 | Slippage=0.000% | Spread=11bps[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.4. ðŸ’µ Minimum Order Notional[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1378     [0m | [1mValidating minimum notional requirements...[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1410     [0m | [1mâœ… [PARADEX] DYDX notional $700.01 meets minimum $10.00[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1410     [0m | [1mâœ… [LIGHTER] DYDX notional $699.36 meets minimum $10.00[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1415     [0m | [1mâœ… All pre-flight checks passed[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.2. ðŸš€ Order Placement[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:143         [0m | [1mðŸš€ Placing all orders simultaneously...[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸŸ¢ [PARADEX] Executing buy DYDX ($700.01364 qty=2340.4) in mode limit_only[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2979, ask=0.2991[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[PARADEX] Placing limit buy DYDX (contract_id=DYDX-USD-PERP): 2340.4 @ $0.2990 (mid: $0.2985, offset: 0.0200%)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸ”´ [LIGHTER] Executing sell DYDX ($699.358328 qty=2340.4) in mode limit_only[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29882, ask=0.29917[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[LIGHTER] Placing limit sell DYDX (contract_id=62): 2340.4 @ $0.29888 (mid: $0.298995, offset: 0.0200%)[0m
[32m2025-11-13 18:52:10[0m | [1mINFO    [0m | [36morder_manager:place_limit_order:185     [0m | [1mðŸ“¤ [LIGHTER] Submitting order: market=62 client_id=930981 side=ASK price=29888 amount=23404[0m
[32m2025-11-13 18:52:11[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:107   [0m | [1m[WEBSOCKET] [PARADEX] CANCELED 0.0 @ 0.299[0m
[32m2025-11-13 18:52:11[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:484       [0m | [1m[PARADEX] Limit order cancelled: not_enough_margin (order_id=1763059931130201709270170000)[0m
[32m2025-11-13 18:52:18[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:171   [0m | [1m[WEBSOCKET] [LIGHTER] OPEN 2340.4 @ 0.29888[0m
[32m2025-11-13 18:52:29[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] PARTIALLY_FILLED 7.1 @ 0.29888[0m
[32m2025-11-13 18:52:30[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] FILLED 2340.4 @ 0.29888[0m
[32m2025-11-13 18:52:30[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: SELL 2340.4 @ 0.29888 | Order: 930981 | Status: FILLED[0m
[32m2025-11-13 18:52:30[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:445       [0m | [1m[LIGHTER] Limit order filled: 2340.4 @ $0.29888[0m
[32m2025-11-13 18:52:30[0m | [1mINFO    [0m | [36mexecutor:_handle_full_fill_trigger:873  [0m | [1mâœ… LIGHTER DYDX fully filled (2340.4). Cancelling remaining limit orders and hedging to prevent directional exposure.[0m
[32m2025-11-13 18:52:30[0m | [1mINFO    [0m | [36mexecutor:_handle_full_fill_trigger:882  [0m | [1mðŸ”„ Cancelling limit order for PARADEX DYDX (remaining: 2340.4) â†’ will hedge with market order[0m
[32m2025-11-13 18:52:31[0m | [1mINFO    [0m | [36mhedge_manager:hedge:81                  [0m | [1mâš¡ Hedging DYDX on PARADEX for remaining qty=2340.4, $700.01[0m
[32m2025-11-13 18:52:31[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸŸ¢ [PARADEX] Executing buy DYDX (qty=2340.4) in mode market_only[0m
[32m2025-11-13 18:52:31[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2981, ask=0.299[0m
[32m2025-11-13 18:52:31[0m | [1mINFO    [0m | [36morder_executor:_execute_market:588      [0m | [1m[PARADEX] Placing market buy DYDX (contract_id=DYDX-USD-PERP): 2340.4 @ ~$0.299[0m
[32m2025-11-13 18:52:31[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:107   [0m | [1m[WEBSOCKET] [PARADEX] CANCELED 0.0 @ 0.2992[0m
[32m2025-11-13 18:52:32[0m | [31m[1mERROR   [0m | [36morder_executor:_execute_market:676      [0m | [31m[1m[PARADEX] Market order canceled: 1763059951350201709221780007 | Status: CANCELED | Reason: not_enough_margin[0m
[32m2025-11-13 18:52:32[0m | [31m[1mERROR   [0m | [36mhedge_manager:hedge:112                 [0m | [31m[1mMarket order canceled: CANCELED (not_enough_margin)[0m
[32m2025-11-13 18:52:32[0m | [33m[1mWARNING [0m | [36mexecutor:_handle_full_fill_trigger:993  [0m | [33m[1mHedge failed (Market order canceled: CANCELED (not_enough_margin)) â€” attempting rollback of partial fills[0m
[32m2025-11-13 18:52:32[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1451   [0m | [33m[1mðŸš¨ EMERGENCY ROLLBACK (OPEN OPERATION): Closing 1 filled orders[0m
[32m2025-11-13 18:52:32[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1457   [0m | [1mStep 1/3: Canceling all orders to prevent further fills...[0m
[32m2025-11-13 18:52:33[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1570   [0m | [1mStep 2/3: Querying actual filled amounts...[0m
[32m2025-11-13 18:52:33[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1640   [0m | [1mStep 3/3: Closing 1 filled positions...[0m
[32m2025-11-13 18:52:33[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1650   [0m | [1mRollback: buy DYDX 2340.4 @ market (contract_id=62, exchange=lighter)[0m
[32m2025-11-13 18:52:33[0m | [1mINFO    [0m | [36morder_manager:place_market_order:392    [0m | [1mðŸ“¤ [LIGHTER] Placing market order: market=62, client_id=953767, side=BUY, base_amount=23404, avg_execution_price=31410[0m
[32m2025-11-13 18:52:34[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1696   [0m | [33m[1mRollback cost for DYDX: $0.00 (entry: $0.29888, exit: $0.29888)[0m
[32m2025-11-13 18:52:34[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1701   [0m | [33m[1mâœ… Rollback complete. Total cost: $0.00[0m
[32m2025-11-13 18:52:34[0m | [33m[1mWARNING [0m | [36m...:_handle_full_fill_trigger:1036      [0m | [33m[1mRollback completed after hedge failure; total cost $0.0000[0m
[32m2025-11-13 18:52:35[0m | [1mINFO    [0m | [36m...:reconcile_context_after_cancel:169  [0m | [1mReconcile: DYDX order 930981 - adding fill: additional=2340.4 @ 0.29888, total will be 2340.4[0m
[32m2025-11-13 18:52:35[0m | [31m[1mERROR   [0m | [36mposition_opener:_execute_trade:286      [0m | [31m[1mâŒ DYDX: Atomic execution failed - Market order canceled: CANCELED (not_enough_margin)[0m
[32m2025-11-13 18:52:35[0m | [33m[1mWARNING [0m | [36mposition_opener:_execute_trade:291      [0m | [33m[1mðŸ”„ Emergency rollback performed, cost: $0.00[0m
[32m2025-11-13 18:52:38[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] FILLED 2340.4 @ 0.31410[0m
[32m2025-11-13 18:52:38[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: BUY 2340.4 @ 0.31410 | Order: 953767 | Status: FILLED[0m
[32m2025-11-13 18:52:38[0m | [33m[1mWARNING [0m | [36m...:handle_positions_stream_update:435  [0m | [33m[1mâš ï¸ [LIGHTER] Position suddenly zeroed: DYDX | Previous qty: 2340.4 | Market ID: 62 | Possible liquidation (no liquidation notification received)[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mstrategy:execute_strategy:229           [0m | [1mScanning for new funding arbitrage opportunities[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 2 raw opportunities, 2 after filtering, returning top 2[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:71             [0m | [1mâ­ï¸  Skipped opportunities for symbols: CC (temporary filter)[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:73             [0m | [1mFound 1 opportunities[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m1. ðŸ“‹ DYDX â€¢ Opportunity Validation[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:209      [0m | [1mEnsuring DYDX is tradeable on both paradex and lighter[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:988     [0m | [1mðŸ”§ [PARADEX] Initializing contract attributes for DYDX[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:1006    [0m | [1mâœ… [PARADEX] DYDX initialized â†’ contract_id=DYDX-USD-PERP, tick_size=0.0001[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:228      [0m | [1mâœ… DYDX available on both PARADEX and LIGHTER[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m2. ðŸ” Leverage Validation & Normalization[0m
[32m2025-11-13 18:53:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:08[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:53:09[0m | [1mINFO    [0m | [36mleverage_valid:get_max_position_size:266[0m | [1mâœ… [LEVERAGE] Position size $700.00 supported by all exchanges[0m
[32m2025-11-13 18:53:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [PARADEX] Max leverage for DYDX: 20x[0m
[32m2025-11-13 18:53:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [LIGHTER] Max leverage for DYDX: 5x[0m
[32m2025-11-13 18:53:09[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:345      [0m | [1mðŸ”§ [LEVERAGE] Normalizing to minimum leverage: 5x (limited by lighter)[0m
[32m2025-11-13 18:53:09[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:367[0m | [1m[PARADEX] Setting leverage for DYDX (DYDX-USD-PERP) to 5x...[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:389[0m | [1mâœ… [PARADEX] Successfully set leverage to 5x for DYDX (DYDX-USD-PERP)[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:363      [0m | [1mâœ… [PARADEX] Leverage set to 5x for DYDX[0m
[32m2025-11-13 18:53:10[0m | [33m[1mWARNING [0m | [36m...:normalize_and_set_leverage:355      [0m | [33m[1mâš ï¸  [LIGHTER] Does not support set_account_leverage(), skipping[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:375      [0m | [1mâœ… [LEVERAGE] All exchanges normalized to 5x for DYDX[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:247      [0m | [1mðŸŽ¯ Execution plan for DYDX: Long PARADEX ($700.00) | Short LIGHTER ($700.00) | Divergence 0.034%[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3. ðŸ§¨ Atomic Multi-Order Execution[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2981, ask=0.2994[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29853, ask=0.29905[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:116         [0m | [1mStarting atomic execution of 2 orders (rollback_on_partial=True)[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1. ðŸ” Pre-flight Checks[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.2. ðŸ’° Margin & Balance Checks[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1277     [0m | [1mRunning balance checks...[0m
[32m2025-11-13 18:53:10[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:291   [0m | [1mðŸ“Š [PARADEX] Leverage info for DYDX:
  - Symbol max leverage: 20.0x
  - Account leverage: N/Ax
  - Max notional: 4860000
  - Margin requirement: 0.0500 (5.0%)[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:258   [0m | [1mðŸ“Š [LIGHTER] Leverage info for DYDX:
  - Symbol max leverage: 5.0x
  - Account leverage: 5E+2x
  - Max notional: None
  - Margin requirement: 0.2 (20.0%)[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… paradex balance OK: $127.30 >= $36.75[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… lighter balance OK: $240.27 >= $146.57[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.3. ðŸŒŠ Order Book Liquidity[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1349     [0m | [1mRunning liquidity checks...[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36mmarket_data:get_order_book_depth:216    [0m | [1mðŸ“¡ [PARADEX] Using WebSocket order book with exact BBO prices: DYDX-USD-PERP (2 bids, 2 asks) | Best: 0.2981/0.299 | Spread: 30 bps[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:172     [0m | [1mðŸ“Š [LIQUIDITY-paradex] DYDX: 2 bids, 2 asks | Best: 0.2981/0.299 | Spread: 30 bps[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:189     [0m | [1mðŸ“ˆ [LIQUIDITY-paradex] Fill analysis: Can fill: True, Levels needed: 2/2, Total available: $700.00[0m
[32m2025-11-13 18:53:11[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:239     [0m | [1mâŒ [LIQUIDITY-paradex] VERDICT for buy $699.99720 DYDX: Recommendation='high_slippage_warning' | Score=0.64 | Slippage=4.913% | Spread=30bps[0m
[32m2025-11-13 18:53:11[0m | [33m[1mWARNING [0m | [36mliquidity_an:is_execution_acceptable:420[0m | [33m[1mSlippage 4.913% exceeds max 0.500%[0m
[32m2025-11-13 18:53:11[0m | [33m[1mWARNING [0m | [36mexecutor:_run_preflight_checks:1369     [0m | [33m[1mâŒ Order 0 (buy DYDX) failed liquidity check: high_slippage_warning[0m
[32m2025-11-13 18:53:11[0m | [31m[1mERROR   [0m | [36mposition_opener:_execute_trade:286      [0m | [31m[1mâŒ DYDX: Atomic execution failed - Pre-flight check failed: Order 0 (buy DYDX) failed liquidity check: high_slippage_warning[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mstrategy:execute_strategy:229           [0m | [1mScanning for new funding arbitrage opportunities[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mopportunity_finde:find_opportunities:171[0m | [1mFound 2 raw opportunities, 2 after filtering, returning top 2[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:71             [0m | [1mâ­ï¸  Skipped opportunities for symbols: CC (temporary filter)[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mopportunity_scanner:scan:73             [0m | [1mFound 1 opportunities[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mopportunity:_calculate_position_size:210[0m | [1mðŸ“Š [DYDX] Calculated position size: target_margin=$140.00 Ã— leverage=5x = $700.00 exposure[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m1. ðŸ“‹ DYDX â€¢ Opportunity Validation[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:209      [0m | [1mEnsuring DYDX is tradeable on both paradex and lighter[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:988     [0m | [1mðŸ”§ [PARADEX] Initializing contract attributes for DYDX[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36m...:_ensure_contract_attributes:1006    [0m | [1mâœ… [PARADEX] DYDX initialized â†’ contract_id=DYDX-USD-PERP, tick_size=0.0001[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:228      [0m | [1mâœ… DYDX available on both PARADEX and LIGHTER[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m2. ðŸ” Leverage Validation & Normalization[0m
[32m2025-11-13 18:54:07[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:08[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36mleverage_valid:get_max_position_size:266[0m | [1mâœ… [LEVERAGE] Position size $700.00 supported by all exchanges[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [PARADEX] Max leverage for DYDX: 20x[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:329      [0m | [1mðŸ“Š [LIGHTER] Max leverage for DYDX: 5x[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:345      [0m | [1mðŸ”§ [LEVERAGE] Normalizing to minimum leverage: 5x (limited by lighter)[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:367[0m | [1m[PARADEX] Setting leverage for DYDX (DYDX-USD-PERP) to 5x...[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36maccount_manager:set_account_leverage:389[0m | [1mâœ… [PARADEX] Successfully set leverage to 5x for DYDX (DYDX-USD-PERP)[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:363      [0m | [1mâœ… [PARADEX] Leverage set to 5x for DYDX[0m
[32m2025-11-13 18:54:10[0m | [33m[1mWARNING [0m | [36m...:normalize_and_set_leverage:355      [0m | [33m[1mâš ï¸  [LIGHTER] Does not support set_account_leverage(), skipping[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36m...:normalize_and_set_leverage:375      [0m | [1mâœ… [LEVERAGE] All exchanges normalized to 5x for DYDX[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36mposition_opener:_execute_trade:247      [0m | [1mðŸŽ¯ Execution plan for DYDX: Long PARADEX ($700.00) | Short LIGHTER ($700.00) | Divergence 0.034%[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3. ðŸ§¨ Atomic Multi-Order Execution[0m
[32m2025-11-13 18:54:10[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2979, ask=0.2989[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29875, ask=0.29903[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:116         [0m | [1mStarting atomic execution of 2 orders (rollback_on_partial=True)[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1. ðŸ” Pre-flight Checks[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.2. ðŸ’° Margin & Balance Checks[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1277     [0m | [1mRunning balance checks...[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:291   [0m | [1mðŸ“Š [PARADEX] Leverage info for DYDX:
  - Symbol max leverage: 20.0x
  - Account leverage: N/Ax
  - Max notional: 4860000
  - Margin requirement: 0.0500 (5.0%)[0m
[32m2025-11-13 18:54:11[0m | [1mINFO    [0m | [36maccount_manager:get_leverage_info:258   [0m | [1mðŸ“Š [LIGHTER] Leverage info for DYDX:
  - Symbol max leverage: 5.0x
  - Account leverage: 5E+2x
  - Max notional: None
  - Margin requirement: 0.2 (20.0%)[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… paradex balance OK: $127.30 >= $36.75[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36maccount_manager:get_account_balance:133 [0m | [1m[LIGHTER] get_account_balance WebSocket user_stats not available, using REST fallback (300 weight)[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1344     [0m | [1mâœ… lighter balance OK: $240.27 >= $146.92[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.3. ðŸŒŠ Order Book Liquidity[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1349     [0m | [1mRunning liquidity checks...[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mmarket_data:get_order_book_depth:216    [0m | [1mðŸ“¡ [PARADEX] Using WebSocket order book with exact BBO prices: DYDX-USD-PERP (2 bids, 2 asks) | Best: 0.2979/0.2989 | Spread: 34 bps[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:172     [0m | [1mðŸ“Š [LIQUIDITY-paradex] DYDX: 2 bids, 2 asks | Best: 0.2979/0.2989 | Spread: 33 bps[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:189     [0m | [1mðŸ“ˆ [LIQUIDITY-paradex] Fill analysis: Can fill: True, Levels needed: 1/2, Total available: $699.99[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:239     [0m | [1mâœ… [LIQUIDITY-paradex] VERDICT for buy $699.99391 DYDX: Recommendation='use_limit' | Score=0.93 | Slippage=0.000% | Spread=33bps[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mmarket_data:get_order_book_depth:360    [0m | [1mðŸ“¡ [LIGHTER] Using real-time order book from WebSocket (20 bids, 20 asks)[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:172     [0m | [1mðŸ“Š [LIQUIDITY-lighter] DYDX: 20 bids, 20 asks | Best: 0.29841/0.29903 | Spread: 20 bps[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:189     [0m | [1mðŸ“ˆ [LIQUIDITY-lighter] Fill analysis: Can fill: True, Levels needed: 1/20, Total available: $699.64[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:check_execution_feasibility:239     [0m | [1mâœ… [LIQUIDITY-lighter] VERDICT for sell $699.642625 DYDX: Recommendation='use_limit' | Score=0.96 | Slippage=0.000% | Spread=20bps[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.1.4. ðŸ’µ Minimum Order Notional[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1378     [0m | [1mValidating minimum notional requirements...[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1410     [0m | [1mâœ… [PARADEX] DYDX notional $699.99 meets minimum $10.00[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1410     [0m | [1mâœ… [LIGHTER] DYDX notional $699.64 meets minimum $10.00[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:_run_preflight_checks:1415     [0m | [1mâœ… All pre-flight checks passed[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m3.2. ðŸš€ Order Placement[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36munified_logger:_emit:618                [0m | [1m=======================================================[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mexecutor:execute_atomically:143         [0m | [1mðŸš€ Placing all orders simultaneously...[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸŸ¢ [PARADEX] Executing buy DYDX ($699.99391 qty=2341.9) in mode limit_only[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [PARADEX] BBO: bid=0.2979, ask=0.2989[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[PARADEX] Placing limit buy DYDX (contract_id=DYDX-USD-PERP): 2341.9 @ $0.2988 (mid: $0.2984, offset: 0.0200%)[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36morder_executor:execute_order:173        [0m | [1mðŸ”´ [LIGHTER] Executing sell DYDX ($699.642625 qty=2341.9) in mode limit_only[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36mprice_provider:_fetch_exchange_bbo:76   [0m | [1mâœ… [LIGHTER] BBO: bid=0.29841, ask=0.29903[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:311       [0m | [1m[LIGHTER] Placing limit sell DYDX (contract_id=62): 2341.9 @ $0.29847 (mid: $0.29872, offset: 0.0200%)[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36morder_manager:place_limit_order:185     [0m | [1mðŸ“¤ [LIGHTER] Submitting order: market=62 client_id=52390 side=ASK price=29847 amount=23419[0m
[32m2025-11-13 18:54:12[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:107   [0m | [1m[WEBSOCKET] [PARADEX] CANCELED 0.0 @ 0.2988[0m
[32m2025-11-13 18:54:13[0m | [1mINFO    [0m | [36morder_executor:_execute_limit:484       [0m | [1m[PARADEX] Limit order cancelled: not_enough_margin (order_id=1763060052530201709221780000)[0m
[32m2025-11-13 18:54:17[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] CANCELED 0.0 @ 0.29847[0m
[32m2025-11-13 18:54:17[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: SELL 0.0 @ 0.29847 | Order: 52390 | Status: CANCELED[0m
[32m2025-11-13 18:54:17[0m | [33m[1mWARNING [0m | [36morder_executor:_execute_limit:472       [0m | [33m[1m[LIGHTER] Limit order cancelled due to post_only_violation (order_id=52390). Order will be retried with fresh BBO.[0m
[32m2025-11-13 18:54:18[0m | [1mINFO    [0m | [36m...:reconcile_context_after_cancel:169  [0m | [1mReconcile: DYDX order 52390 - adding fill: additional=2341.9 @ 0.29847, total will be 2341.9[0m
[32m2025-11-13 18:54:18[0m | [31m[1mERROR   [0m | [36mexecutor:execute_atomically:406         [0m | [31m[1mQuantity imbalance detected after hedge: longs=0.000000 tokens, shorts=2341.900000 tokens, imbalance=2341.900000 tokens (100.00%)[0m
[32m2025-11-13 18:54:18[0m | [33m[1mWARNING [0m | [36mexecutor:execute_atomically:417         [0m | [33m[1mâš ï¸ Critical quantity imbalance 2341.900000 tokens (100.00%) detected after retries exhausted. Initiating rollback to close 1 filled positions.[0m
[32m2025-11-13 18:54:18[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1451   [0m | [33m[1mðŸš¨ EMERGENCY ROLLBACK (OPEN OPERATION): Closing 1 filled orders[0m
[32m2025-11-13 18:54:18[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1457   [0m | [1mStep 1/3: Canceling all orders to prevent further fills...[0m
[32m2025-11-13 18:54:19[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1570   [0m | [1mStep 2/3: Querying actual filled amounts...[0m
[32m2025-11-13 18:54:19[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1640   [0m | [1mStep 3/3: Closing 1 filled positions...[0m
[32m2025-11-13 18:54:19[0m | [1mINFO    [0m | [36mexecutor:_rollback_filled_orders:1650   [0m | [1mRollback: buy DYDX 2341.9 @ market (contract_id=62, exchange=lighter)[0m
[32m2025-11-13 18:54:19[0m | [1mINFO    [0m | [36morder_manager:place_market_order:392    [0m | [1mðŸ“¤ [LIGHTER] Placing market order: market=62, client_id=59527, side=BUY, base_amount=23419, avg_execution_price=31365[0m
[32m2025-11-13 18:54:19[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1696   [0m | [33m[1mRollback cost for DYDX: $0.00 (entry: $0.29847, exit: $0.29847)[0m
[32m2025-11-13 18:54:19[0m | [33m[1mWARNING [0m | [36mexecutor:_rollback_filled_orders:1701   [0m | [33m[1mâœ… Rollback complete. Total cost: $0.00[0m
[32m2025-11-13 18:54:19[0m | [33m[1mWARNING [0m | [36m...:_perform_emergency_rollback:784     [0m | [33m[1mðŸ›¡ï¸ Emergency rollback completed; cost=$0.0000. Prevented 2341.900000 tokens (100.00%) quantity imbalance.[0m
[32m2025-11-13 18:54:19[0m | [31m[1mERROR   [0m | [36mposition_opener:_execute_trade:286      [0m | [31m[1mâŒ DYDX: Atomic execution failed - Rolled back due to critical imbalance: Partial fill: 1/2; quantity imbalance 2341.900000 tokens (100.00%)[0m
[32m2025-11-13 18:54:19[0m | [33m[1mWARNING [0m | [36mposition_opener:_execute_trade:291      [0m | [33m[1mðŸ”„ Emergency rollback performed, cost: $0.00[0m
[32m2025-11-13 18:54:23[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:182   [0m | [1m[WEBSOCKET] [LIGHTER] FILLED 2341.9 @ 0.31365[0m
[32m2025-11-13 18:54:23[0m | [1mINFO    [0m | [36m...:handle_websocket_order_update:212   [0m | [1mTRANSACTION: BUY 2341.9 @ 0.31365 | Order: 59527 | Status: FILLED[0m
[32m2025-11-13 18:54:48[0m | [1mINFO    [0m | [36mtrading_bot:_override_signal_handler:416[0m | [1mðŸ“¡ Signal handler called: SIGTERM[0m
[32m2025-11-13 18:54:48[0m | [1mINFO    [0m | [36mtrading_bot:graceful_shutdown:310       [0m | [1mðŸ›‘ Graceful shutdown initiated: Shutdown requested[0m
[32m2025-11-13 18:54:48[0m | [1mINFO    [0m | [36mposition_manager:shutdown:1069          [0m | [1mDatabase connection closed[0m
[32m2025-11-13 18:54:48[0m | [1mINFO    [0m | [36mbase_strategy:cleanup:186               [0m | [1mStrategy 'Funding Rate Arbitrage' cleanup completed[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mmanager:_log:98                         [0m | [1mWebSocket disconnected[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mmanager:_log:79                         [0m | [1mWebSocket listener stopped[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mmanager:_log:79                         [0m | [1mWebSocket disconnected[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mmanager:disconnect:145                  [0m | [1m[PARADEX] WebSocket disconnected[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mtrading_bot:graceful_shutdown:358       [0m | [1mâœ… Disconnected from: aster, lighter, paradex[0m
[32m2025-11-13 18:54:49[0m | [1mINFO    [0m | [36mtrading_bot:graceful_shutdown:359       [0m | [1mâœ… Shutdown complete[0m
